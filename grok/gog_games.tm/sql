-- short_notes and wine_specials are now flag fields
-- also dropped "fields" table for now
-- also reordered fields in more natural order
-- also use preferred data types, even though sqlite3 doesn't care
-- also renamed some fields
-- all fields NOT NULL; use '' for empty strings
DROP TABLE gog_games;
BEGIN;
CREATE TABLE gog_games (
   name VARCHAR(100) NOT NULL, version VARCHAR(40) NOT NULL,
     gog_id VARCHAR(64) NOT NULL UNIQUE,
   command VARCHAR(30) NOT NULL, command_type VARCHAR(15) NOT NULL
     CHECK (command_type IN ('Linux','Windows','DOS','ScummVM','AGS','Infocom')),
   -- INTEGER is used for install size, assuming >= 32-bit
   -- BIGINT is used for download size, assuming > 32-bit
   -- could also use MUMERIC(8) and NUMERIC(10), respectively, but slow
   --  on postgres and others that store decimal digits for some insane reason
   install_dir VARCHAR(100) NOT NULL, install_size_k INTEGER NOT NULL,
     download_size BIGINT NOT NULL,
   -- TEXT or CLOB for text areas? VARCHAR >= 500 is good as well.
   -- dlc should actually be a child table
   dlc VARCHAR(1024) NOT NULL,
   hidden VARCHAR(100) NOT NULL,
   install_notes VARCHAR(1024) NOT NULL, game_notes VARCHAR(1024) NOT NULL,
     todo VARCHAR(1024) NOT NULL,
   -- short notes (flags)
   short_notes_3rd_party_linux BOOLEAN NOT NULL,
   short_notes_amiga BOOLEAN NOT NULL,
   short_notes_broken BOOLEAN NOT NULL,
   short_notes_editor BOOLEAN NOT NULL,
   short_notes_finished BOOLEAN NOT NULL,
   short_notes_open_source BOOLEAN NOT NULL,
   short_notes_linux_broken BOOLEAN NOT NULL,
   short_notes_mods BOOLEAN NOT NULL,
   short_notes_bad_movies BOOLEAN NOT NULL,
   short_notes_slow BOOLEAN NOT NULL,
   short_notes_uninstalled BOOLEAN NOT NULL,
   short_notes_editor_broken BOOLEAN NOT NULL,
   short_notes_bad_music BOOLEAN NOT NULL,
   short_notes_brittle BOOLEAN NOT NULL,
   short_notes_win_editor BOOLEAN NOT NULL,
   short_notes_bad_full_screen BOOLEAN NOT NULL,
   short_notes_iconifies BOOLEAN NOT NULL,
   -- following fields should be in a separate "Wine" tab
   -- should also probably make this a foriegn key
   wine_version VARCHAR(32) NOT NULL,
   config_location VARCHAR(128) NOT NULL, save_location VARCHAR(128) NOT NULL,
   -- wine specials (flags)
   wine_specials_dxvk BOOLEAN NOT NULL,
   wine_specials_dx11_disabled BOOLEAN NOT NULL,
   wine_specials_64_bit BOOLEAN NOT NULL);
\{SUBST '=''}
\{FOREACH}
INSERT INTO gog_games
   (name, version, gog_id, command, command_type,
    install_dir, install_size_k, download_size,
    dlc, hidden, install_notes, game_notes, todo,
    short_notes_3rd_party_linux, short_notes_amiga,
    short_notes_broken, short_notes_editor, short_notes_finished,
    short_notes_open_source, short_notes_linux_broken, short_notes_mods,
    short_notes_bad_movies, short_notes_slow, short_notes_uninstalled,
    short_notes_editor_broken,
    short_notes_bad_music, short_notes_brittle, short_notes_win_editor,
    short_notes_bad_full_screen,
    short_notes_iconifies,
    wine_version, config_location, save_location,
    wine_specials_dxvk, wine_specials_dx11_disabled, wine_specials_64_bit)
VALUES
   ('\{_name}', '\{_ver}', '\{_id}', '\{_cmd}', '\{_cmdtype}',
    '\{_dir}', \{_inst_size ? _inst_size : "0"}, \{_setup_size ? _setup_size : "0"},
    '\{_dlc}', '\{_hidden}', '\{_inst_notes}', '\{_game_notes}', '\{_todo}',
    \{_sn_3plinux ? "TRUE" : "FALSE"}, \{_sn_amiga ? "TRUE" : "FALSE"},
    \{_sn_broken ? "TRUE" : "FALSE"}, \{_sn_editor ? "TRUE" : "FALSE"},
    \{_sn_finished ? "TRUE" : "FALSE"}, \{_sn_source ? "TRUE" : "FALSE"},
    \{_sn_linuxbroken ? "TRUE" : "FALSE"}, \{_sn_mods ? "TRUE" : "FALSE"},
    \{_sn_nomovies ? "TRUE" : "FALSE"}, \{_sn_slow ? "TRUE" : "FALSE"},
    \{_sn_uninstalled ? "TRUE" : "FALSE"},
    \{_sn_editorbroken ? "TRUE" : "FALSE"}, \{_sn_nomusic ? "TRUE" : "FALSE"},
    \{_sn_brittle ? "TRUE" : "FALSE"}, \{_sn_wineditor ? "TRUE" : "FALSE"},
    \{_sn_badfullscreen ? "TRUE" : "FALSE"}, \{_sn_iconifies ? "TRUE" : "FALSE"},
    '\{_wine_ver}', '\{_config_loc}', '\{_save_loc}',
    \{_ws_dxvk ? "TRUE" : "FALSE"}, \{_ws_dx11_disable ? "TRUE" : "FALSE"},
    \{_ws_64bit ? "TRUE" : "FALSE"});
\{END}
COMMIT;
